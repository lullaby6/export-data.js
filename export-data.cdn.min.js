window.exportData={title:(e="",t=!1)=>`${e?`${e} `:""}${e&&t?" - ":""} ${t?new Date().toLocaleDateString():""}`,file:(e="")=>`${e?`${e} - `:""}${new Date().toLocaleDateString()}`,dataToCSV(e){let t=Object.keys(e[0]),a=e.map(e=>Object.values(e).join(","));return[t.join(","),...a].join("\n")},printHTML(e,t,a){let l=document.createElement("iframe");l.style.display="none",document.body.appendChild(l);let o=l.contentWindow||l.contentDocument;o.document.open(),o.document.write(`<html><head>${t?`<title>${t}</title>`:""}<style>body {font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;}table {border-collapse: collapse;width: 100%;}th, td {padding: 8px;text-align: left;border: 1px solid #000;}h1 {text-align: center;font-size: 24px;font-weight: 400;}img {width: 100%;}</style></head><body onload="this.focus(); this.print();">${t||a?`<h1>${exportData.title(t,a)}</h1>`:""}${e}</body></html>`),o.document.close(),setTimeout(()=>{document.body.removeChild(l)},1e3)},download(e,t){let a=document.createElement("a");a.href=e,a.download=exportData.file(t),document.body.appendChild(a),a.click(),document.body.removeChild(a)},xlsx:(e,t)=>exportData.download(`data:application/vnd.openxmlformats-officedocument.spreadsheetml.sheet;charset=utf-8,${encodeURIComponent(exportData.dataToCSV(e))}`,t),excel:(e,t)=>exportData.xlsx(e,t),csv:(e,t)=>exportData.download(`data:text/csv;charset=utf-8,${encodeURIComponent(exportData.dataToCSV(e))}`,t),json:(e,t)=>exportData.download(`data:application/json;charset=utf-8,${encodeURIComponent(JSON.stringify(e,null,2))}`,t),print(e,t,a){exportData.printHTML(`<table><thead><tr>${Object.keys(e[0]).map(e=>`<th>${e}</th>`).join("")}</tr></thead><tbody>${e.map(e=>`<tr>${Object.values(e).map(e=>`<td>${e}</td>`).join("")}</tr>`).join("")}</tbody></table>`,t,a)},loadPDF(e,t,a,l="grid",o=()=>{}){if(void 0===window.jsPDF){try{let n=document.createElement("script");n.src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/1.5.3/jspdf.min.js",document.head.appendChild(n),n.onload=()=>{let n=document.createElement("script");n.src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.6/jspdf.plugin.autotable.min.js",document.head.appendChild(n),n.onload=()=>{exportData.loadPDF(e,t,a,l,o)}}}catch(d){console.error(d)}return}let i=new jsPDF;if(i.setLineWidth(2),i.setFontSize(16),t||a){let r=exportData.title(t,a),s=i.internal.pageSize.getWidth(),c=i.getTextWidth(r);i.text(r,(s-c)/2,12.5)}let p=Object.keys(e[0]),h=e.map(e=>Object.values(e));return i.autoTable({head:[p],body:h,theme:l,startY:t||a?20:10}),o(i),i},pdf:(e,t,a,l="grid")=>exportData.loadPDF(e,t,a,l,e=>e.save(`${exportData.file(t,a)}.pdf`)),printPDF:(e,t,a,l="grid")=>exportData.loadPDF(e,t,a,l,e=>{let t=e.output("blob"),a=URL.createObjectURL(t),l=window.open(a);l&&(l.onload=()=>{l.print(),l.onafterprint=()=>{l.close(),URL.revokeObjectURL(a)},l.onbeforeunload=()=>{l.close(),URL.revokeObjectURL(a)},setTimeout(()=>{l.closed||(l.close(),URL.revokeObjectURL(a))},5e3)})}),loadImage(e,t=300){let a=document.createElement("canvas"),l=a.getContext("2d"),o=t*Object.keys(e[0]).length,n=20*(e.length+1)+16;a.width=o,a.height=n,l.fillStyle="#fff",l.fillRect(0,0,o,n),l.strokeStyle="#000",l.strokeRect(0,0,o,n),l.font="14px Arial",l.fillStyle="#000";let d=Object.keys(e[0]);return d.forEach((e,a)=>{l.fillText(e,8+a*t,15.5),l.strokeRect(a*t,0,t,20)}),e.forEach((e,a)=>{d.forEach((o,n)=>{l.fillText(e[o],8+n*t,8+(a+2)*20-12.5),l.strokeRect(n*t,(a+1)*20,t,20)})}),a.toDataURL("image/png")},image:(e,t,a=300)=>exportData.download(exportData.loadImage(e,a),t),printImage(e,t,a,l=300){let o=exportData.loadImage(e,l);exportData.printHTML(`<img src="${o}">`,t,a)}};